<view><view class="content"><image class="logo" src="/static/ble.png"></image></view><view class="uni-padding-wrap uni-common-mt"><view class="uni-btn-v"><button type="primary" loading="{{searchLoad}}" disabled="{{disabled[1]}}" data-event-opts="{{[['tap',[['startBluetoothDevicesDiscovery',['$event']]]]]}}" bindtap="__e">开始搜索蓝牙设备</button><button type="primary" disabled="{{disabled[2]}}" data-event-opts="{{[['tap',[['stopBluetoothDevicesDiscovery',[false]]]]]}}" bindtap="__e">停止搜索蓝牙设备</button><button type="primary" loading="{{newDeviceLoad}}" disabled="{{disabled[3]}}" data-event-opts="{{[['tap',[['queryDevices',['$event']]]]]}}" bindtap="__e">选择设备</button><block wx:if="{{equipment.length>0}}"><view>{{''+((connected?'已连接设备':'已选择设备')+' : '+equipment[0].name+' ('+equipment[0].deviceId+')')+''}}</view></block><button type="primary" disabled="{{disabled[4]}}" data-event-opts="{{[['tap',[['createBLEConnection',['$event']]]]]}}" bindtap="__e">连接蓝牙设备并控制风扇</button><block wx:if="{{servicesData.length>0}}"><view>{{"已选服务uuid："+servicesData[0].uuid}}</view></block><block wx:if="{{characteristicsData.length>0}}"><view><view class="uni-list_name">{{"uuid:"+characteristicsData[0].uuid}}</view><view class="uni-list_item">{{'是否支持 read 操作:'+characteristicsData[0].properties.read+''}}</view><view class="uni-list_item">{{'是否支持 write 操作:'+characteristicsData[0].properties.write+''}}</view><view class="uni-list_item">{{'是否支持 notify 操作:'+characteristicsData[0].properties.notify+''}}</view><view class="uni-list_item">{{'是否支持 indicate 操作:'+characteristicsData[0].properties.indicate+''}}</view></view></block><button type="primary" disabled="{{disabled[9]}}" data-event-opts="{{[['tap',[['closeBLEConnection',['$event']]]]]}}" bindtap="__e">断开蓝牙设备</button><button type="primary" disabled="{{disabled[10]}}" data-event-opts="{{[['tap',[['closeBluetoothAdapter',['$event']]]]]}}" bindtap="__e">关闭蓝牙模块</button><button class="uni-btn" type="primary" data-event-opts="{{[['tap',[['navigateBack',['$event']]]]]}}" bindtap="__e">返回</button></view></view><block wx:if="{{maskShow}}"><view data-event-opts="{{[['touchmove',[['moveHandle',['$event']]]],['tap',[['maskclose',['$event']]]]]}}" class="uni-mask" catchtouchmove="__e" bindtap="__e"><scroll-view class="uni-scroll_box" scroll-y="{{true}}" data-event-opts="{{[['touchmove',[['moveHandle',['$event']]]],['tap',[['moveHandle',['$event']]]]]}}" catchtouchmove="__e" catchtap="__e"><view class="uni-title">{{'已经发现'+list.length+(showMaskType==='device'?'台设备':'个服务')+':'}}</view><block wx:for="{{list}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['tapQuery',['$0'],[[['list','',index]]]]]]]}}" class="uni-list-box" bindtap="__e"><block wx:if="{{showMaskType==='device'}}"><view><view class="uni-list_name">{{item.name||item.localName}}</view><view class="uni-list_item">{{"信号强度:"+item.RSSI+"dBm"}}</view><view class="uni-list_item">{{"UUID:"+item.deviceId}}</view></view></block></view></block></scroll-view></view></block></view>